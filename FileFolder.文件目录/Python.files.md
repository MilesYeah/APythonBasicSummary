
# Python Files



## 在文件和sockets结束时, 显式的关闭它.

除文件外, sockets或其他类似文件的对象在没有必要的情况下打开, 会有许多副作用, 例如:

* 它们可能会消耗有限的系统资源, 如文件描述符. 如果这些资源在使用后没有及时归还系统, 那么用于处理这些对象的代码会将资源消耗殆尽.
* 持有文件将会阻止对于文件的其他诸如移动、删除之类的操作.
* 仅仅是从逻辑上关闭文件和sockets, 那么它们仍然可能会被其共享的程序在无意中进行读或者写操作. 只有当它们真正被关闭后, 对于它们尝试进行读或者写操作将会跑出异常, 并使得问题快速显现出来.


而且, 幻想当文件对象析构时, 文件和sockets会自动关闭, 试图将文件对象的生命周期和文件的状态绑定在一起的想法, 都是不现实的. 因为有如下原因:

* 没有任何方法可以确保运行环境会真正的执行文件的析构. 不同的Python实现采用不同的内存管理技术,比如延时垃圾处理机制. 延时垃圾处理机制可能会导致对象生命周期被任意无限制的延长.
* 对于文件意外的引用,会导致对于文件的持有时间超出预期(比如对于异常的跟踪, 包含有全局变量等).

推荐使用 "with"语句 以管理文件:
```py
with open("hello.txt") as hello_file:
    for line in hello_file:
        print line
```


| 模式 | 描述                                               | note                                                                                     |
| ---- | -------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| r    | 只读                                               | 默认模式                                                                                 |
|      |                                                    | 若文件不存在，报错                                                                       |
| r+   | 读写，不创建                                       | 文件指针将会放在文件的开头                                                               |
|      |                                                    | 可读可写，若文件不存在，报错                                                             |
| rt   | 在读取文本时会自动把`\r\n`转换成`\n`               |                                                                                          |
| rb   | 按照二进制位进行读取的，不会将读取的字节转换成字符 |                                                                                          |
| rb+  | 以二进制格式打开一个文件用于读写                   | 文件指针将会放在文件的开头                                                               |
|      |                                                    |                                                                                          |
| w    | 新建只写,会将文件内容清零                          | 不能读出，若不存在会创建新文件                                                           |
| wb   | 以二进制格式打开一个文件只用于写入                 | 如果该文件已存在则将其覆盖                                                               |
|      |                                                    | 如果该文件不存在，创建新文件                                                             |
| wb+  | 以二进制格式打开一个文件用于读写                   | 如果该文件已存在则将其覆盖。                                                             |
|      |                                                    | 如果该文件不存在，创建新文件。                                                           |
| w+   | 新建读写,会将文件内容清零                          | 可读可写，                                                                               |
|      |                                                    | 如果该文件已存在则将其覆盖                                                               |
|      |                                                    | 若文件不存在，创建                                                                       |
| a    | 附加写方式打开，不可读                             | 如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后 |
|      |                                                    | 如果该文件不存在，创建新文件进行写入                                                     |
| a+   | 附加读写方式打开                                   | 如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式                     |
|      |                                                    | 如果该文件不存在，创建新文件用于读写                                                     |
| ab   | 以二进制格式打开一个文件用于追加                   | 如果该文件已存在，文件指针将会放在文件的结尾                                             |
|      |                                                    | 如果该文件不存在，创建新文件进行写入                                                     |
| ab+  | 以二进制格式打开一个文件用于追加                   | 如果该文件已存在，文件指针将会放在文件的结尾。                                           |
|      |                                                    | 如果该文件不存在，创建新文件用于读写                                                     |
|      |                                                    |                                                                                          |
|      |                                                    |                                                                                          |


## ref
* [【Python】python文件打开方式详解——a、a+、r+、w+、rb、rt区别](https://bluebird.blog.csdn.net/article/details/47259805?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ETopBlog-1.topblog&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ETopBlog-1.topblog&utm_relevant_index=1)
* [python文件默认打开方式_python文件打开的几种访问模式](https://blog.csdn.net/weixin_39627361/article/details/109869162?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.topblog&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.topblog&utm_relevant_index=2)
* []()
* []()
* []()
* []()
* []()

