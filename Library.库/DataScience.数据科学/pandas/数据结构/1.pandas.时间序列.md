# pandas.时间序列

```py
>>> from datetime import datetime
>>> t1 = datetime(2020, 9, 18)
>>> t1
>>> datetime.datetime(2020, 9, 18, 0, 0)
>>> dates = [datetime(2020, 10, 10), datetime(2020, 11, 11), datetime(2021, 10, 10), datetime(2021, 10, 11), datetime(2021, 11, 11)]
>>> se = Series(np.random.randn(5), index=dates)
>>> se
2020-10-10    0.159004
2020-11-11   -0.559769
2021-10-10   -0.109258
2021-10-11   -0.271690
2021-11-11    2.275297
dtype: float64
>>> se.values
array([ 0.15900362, -0.55976914, -0.10925825, -0.27168991,  2.27529745])
>>> se.index
DatetimeIndex(['2020-10-10', '2020-11-11', '2021-10-10', '2021-10-11',
               '2021-11-11'],
              dtype='datetime64[ns]', freq=None)

```

```py
>>> se[1]
-0.5597691401120372
>>> se[datetime(2021, 11, 11)]
2.2752974522014777
>>> se['2020-10-10']
0.1590036209094548
>>> se['2020-10']
2020-10-10    0.159004
dtype: float64
>>> se['2021-10']
2021-10-10   -0.109258
2021-10-11   -0.271690
dtype: float64
>>> se['2021']
2021-10-10   -0.109258
2021-10-11   -0.271690
2021-11-11    2.275297
dtype: float64
```

```py
>>> pd.date_range(start='2020-10', periods=10, freq='D')
DatetimeIndex(['2020-10-01', '2020-10-02', '2020-10-03', '2020-10-04',
               '2020-10-05', '2020-10-06', '2020-10-07', '2020-10-08',
               '2020-10-09', '2020-10-10'],
              dtype='datetime64[ns]', freq='D')
>>> pd.date_range(start='2020-10', end='2020-11', freq='D')
DatetimeIndex(['2020-10-01', '2020-10-02', '2020-10-03', '2020-10-04',
               '2020-10-05', '2020-10-06', '2020-10-07', '2020-10-08',
               '2020-10-09', '2020-10-10', '2020-10-11', '2020-10-12',
               '2020-10-13', '2020-10-14', '2020-10-15', '2020-10-16',
               '2020-10-17', '2020-10-18', '2020-10-19', '2020-10-20',
               '2020-10-21', '2020-10-22', '2020-10-23', '2020-10-24',
               '2020-10-25', '2020-10-26', '2020-10-27', '2020-10-28',
               '2020-10-29', '2020-10-30', '2020-10-31', '2020-11-01'],
              dtype='datetime64[ns]', freq='D')
```

```py
>>> pd.date_range(start='2020-10', periods=10, freq='W')        # 每周从周日开始计算
DatetimeIndex(['2020-10-04', '2020-10-11', '2020-10-18', '2020-10-25',
               '2020-11-01', '2020-11-08', '2020-11-15', '2020-11-22',
               '2020-11-29', '2020-12-06'],
              dtype='datetime64[ns]', freq='W-SUN')
>>> pd.date_range(start='2020-10', periods=10, freq='W-MON')        # 每周从周一开始计算
DatetimeIndex(['2020-10-05', '2020-10-12', '2020-10-19', '2020-10-26',
               '2020-11-02', '2020-11-09', '2020-11-16', '2020-11-23',
               '2020-11-30', '2020-12-07'],
              dtype='datetime64[ns]', freq='W-MON')
```

```py
>>> pd.date_range(start='2020-10', periods=10, freq='H')
DatetimeIndex(['2020-10-01 00:00:00', '2020-10-01 01:00:00',
               '2020-10-01 02:00:00', '2020-10-01 03:00:00',
               '2020-10-01 04:00:00', '2020-10-01 05:00:00',
               '2020-10-01 06:00:00', '2020-10-01 07:00:00',
               '2020-10-01 08:00:00', '2020-10-01 09:00:00'],
              dtype='datetime64[ns]', freq='H')
>>> pd.date_range(start='2020-10', periods=10, freq='6H')
DatetimeIndex(['2020-10-01 00:00:00', '2020-10-01 06:00:00',
               '2020-10-01 12:00:00', '2020-10-01 18:00:00',
               '2020-10-02 00:00:00', '2020-10-02 06:00:00',
               '2020-10-02 12:00:00', '2020-10-02 18:00:00',
               '2020-10-03 00:00:00', '2020-10-03 06:00:00'],
              dtype='datetime64[ns]', freq='6H')
```

```py
>>> se = Series(np.random.randn(10), index=pd.date_range('2020-10', periods=10, freq='W-MON'))
>>> se
2020-10-05    0.260908
2020-10-12    1.295785
2020-10-19    0.075956
2020-10-26    0.506736
2020-11-02   -0.048902
2020-11-09   -1.796957
2020-11-16   -1.346492
2020-11-23    0.419541
2020-11-30    0.871195
2020-12-07   -2.217782
Freq: W-MON, dtype: float64
```



## 采样

```py
>>> t_range = pd.date_range('2020-11-25', '2020-12-5')
>>> t_range
DatetimeIndex(['2020-11-25', '2020-11-26', '2020-11-27', '2020-11-28',
               '2020-11-29', '2020-11-30', '2020-12-01', '2020-12-02',
               '2020-12-03', '2020-12-04', '2020-12-05'],
              dtype='datetime64[ns]', freq='D')
>>> len(t_range)
11
>>> se = Series(np.random.randn(11), index=t_range)
>>> se
2020-11-25   -0.628627
2020-11-26   -0.215050
2020-11-27    1.947895
2020-11-28    0.856299
2020-11-29   -0.836989
2020-11-30    0.343429
2020-12-01    0.015942
2020-12-02   -0.680721
2020-12-03    1.493447
2020-12-04   -0.631335
2020-12-05    1.815231
Freq: D, dtype: float64
>>> se['2020-11']
2020-11-25   -0.628627
2020-11-26   -0.215050
2020-11-27    1.947895
2020-11-28    0.856299
2020-11-29   -0.836989
2020-11-30    0.343429
Freq: D, dtype: float64
>>> se['2020-11'].mean()
0.24449290682632238
>>> se.resample('M').mean()
2020-11-30    0.244493
2020-12-31    0.402513
Freq: M, dtype: float64

```


```py
>>> se.resample('12H').ffill()
2020-11-25 00:00:00   -0.628627
2020-11-25 12:00:00   -0.628627
2020-11-26 00:00:00   -0.215050
2020-11-26 12:00:00   -0.215050
2020-11-27 00:00:00    1.947895
2020-11-27 12:00:00    1.947895
2020-11-28 00:00:00    0.856299
2020-11-28 12:00:00    0.856299
2020-11-29 00:00:00   -0.836989
2020-11-29 12:00:00   -0.836989
2020-11-30 00:00:00    0.343429
2020-11-30 12:00:00    0.343429
2020-12-01 00:00:00    0.015942
2020-12-01 12:00:00    0.015942
2020-12-02 00:00:00   -0.680721
2020-12-02 12:00:00   -0.680721
2020-12-03 00:00:00    1.493447
2020-12-03 12:00:00    1.493447
2020-12-04 00:00:00   -0.631335
2020-12-04 12:00:00   -0.631335
2020-12-05 00:00:00    1.815231
Freq: 12H, dtype: float64
>>> se.resample('12H').bfill()
2020-11-25 00:00:00   -0.628627
2020-11-25 12:00:00   -0.215050
2020-11-26 00:00:00   -0.215050
2020-11-26 12:00:00    1.947895
2020-11-27 00:00:00    1.947895
2020-11-27 12:00:00    0.856299
2020-11-28 00:00:00    0.856299
2020-11-28 12:00:00   -0.836989
2020-11-29 00:00:00   -0.836989
2020-11-29 12:00:00    0.343429
2020-11-30 00:00:00    0.343429
2020-11-30 12:00:00    0.015942
2020-12-01 00:00:00    0.015942
2020-12-01 12:00:00   -0.680721
2020-12-02 00:00:00   -0.680721
2020-12-02 12:00:00    1.493447
2020-12-03 00:00:00    1.493447
2020-12-03 12:00:00   -0.631335
2020-12-04 00:00:00   -0.631335
2020-12-04 12:00:00    1.815231
2020-12-05 00:00:00    1.815231
Freq: 12H, dtype: float64
```


```py
>>> t_range = pd.date_range('2016-01-01', '2016-12-31', freq='H')
>>> t_range
DatetimeIndex(['2016-01-01 00:00:00', '2016-01-01 01:00:00',
               '2016-01-01 02:00:00', '2016-01-01 03:00:00',
               '2016-01-01 04:00:00', '2016-01-01 05:00:00',
               '2016-01-01 06:00:00', '2016-01-01 07:00:00',
               '2016-01-01 08:00:00', '2016-01-01 09:00:00',
               ...
               '2016-12-30 15:00:00', '2016-12-30 16:00:00',
               '2016-12-30 17:00:00', '2016-12-30 18:00:00',
               '2016-12-30 19:00:00', '2016-12-30 20:00:00',
               '2016-12-30 21:00:00', '2016-12-30 22:00:00',
               '2016-12-30 23:00:00', '2016-12-31 00:00:00'],
              dtype='datetime64[ns]', length=8761, freq='H')
>>> df_stock = DataFrame(index=t_range)
>>> df_stock['ALI'] = np.random.randint(80, 160, size=len(t_range))
>>> df_stock['TENCENT'] = np.random.randint(30, 60, size=len(t_range))
>>> df_stock
                     ALI  TENCENT
2016-01-01 00:00:00   87       59
2016-01-01 01:00:00  158       59
2016-01-01 02:00:00  101       35
2016-01-01 03:00:00   93       47
2016-01-01 04:00:00  111       33
                  ...      ...
2016-12-30 20:00:00  149       55
2016-12-30 21:00:00  119       42
2016-12-30 22:00:00  104       52
2016-12-30 23:00:00   82       34
2016-12-31 00:00:00  110       57
[8761 rows x 2 columns]
... 
>>> df_stock.plot()
Backend TkAgg is interactive backend. Turning interactive mode on.
<AxesSubplot:>

```


```py
>>> df_week = DataFrame()
>>> df_week['ALI'] = df_stock['ALI'].resample('W').mean()
>>> df_week['TENCENT'] = df_stock['TENCENT'].resample('W').mean()
>>> df_week.plot()
<AxesSubplot:>

```








## 画图


















